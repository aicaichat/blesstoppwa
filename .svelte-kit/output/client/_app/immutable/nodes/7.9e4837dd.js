import{s as gt,n as at,r as Ct,e as St,o as Et,h as Tt,b as Dt}from"../chunks/scheduler.c332f3f7.js";import{S as kt,i as It,g as o,s as f,m as W,x as Ft,h as a,f as n,c as h,j as d,z as C,n as J,k as s,l as Vt,y as e,a as Le,E as mt,A as he,o as st}from"../chunks/index.a647b513.js";import{g as At}from"../chunks/globals.7f7f1b26.js";import{t as K,u as _t,g as Nt}from"../chunks/appState.b697c72e.js";const{document:ot}=At;function yt(i){let r,v='<div class="text-center"><div class="w-8 h-8 border-2 border-yellow-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"></div> <p class="text-yellow-200 text-sm">生成中...</p></div>';return{c(){r=o("div"),r.innerHTML=v,this.h()},l(c){r=a(c,"DIV",{class:!0,"data-svelte-h":!0}),C(r)!=="svelte-b9vc9o"&&(r.innerHTML=v),this.h()},h(){s(r,"class","absolute inset-0 bg-black/50 flex items-center justify-center rounded-lg")},m(c,u){Le(c,r,u)},d(c){c&&n(r)}}}function wt(i){let r,v='<span class="text-yellow-200">验真状态：</span> <span class="text-green-400 font-medium">✅ 已认证</span>';return{c(){r=o("div"),r.innerHTML=v,this.h()},l(c){r=a(c,"DIV",{class:!0,"data-svelte-h":!0}),C(r)!=="svelte-um634u"&&(r.innerHTML=v),this.h()},h(){s(r,"class","flex justify-between")},m(c,u){Le(c,r,u)},d(c){c&&n(r)}}}function Ht(i){var xt;let r,v,c,u,k,ge='<h1 class="text-3xl md:text-4xl font-bold gradient-text mb-4 svelte-11i727h">体验完成！</h1> <p class="text-lg text-yellow-200">将这份平静与更多人分享</p>',Q,y,w,g,A="分享海报",ve,I,L,Z,xe,N,F,be,ie,l,t,S,E,Ce,p,T,j,Se="您的体验总结",pe,b,V,H,q="体验时长：",M,ee,me=(i[5].duration||60)+"",Ee,je,qe,U,te,nt="平静指数：",Re,le,_e=(i[5].calmScore||75)+"",Te,Ue,ze,z,se,rt="对话轮次：",Be,oe,ye=(((xt=i[5].chatHistory)==null?void 0:xt.length)||0)+"",De,Oe,Ge,Xe,P,ae,it="分享文案",$e,R,Ye,B,ct="📋 复制分享文案",We,O,ne,dt="继续探索",Je,G,X,ut="🔄 再次体验",Ke,$,ft="🎯 探索更多功能",Qe,re,ht=`<h3 class="text-2xl font-semibold text-yellow-100 mb-4">传递善缘，功德无量</h3> <p class="text-yellow-200/80 max-w-2xl mx-auto">每一次分享都是慈悲的延续，愿更多人在快节奏的生活中找到内心的宁静。
				您的分享可能正是某个人此刻最需要的温暖。</p>`,Ze,vt,m=i[1]&&yt(),_=i[5].certificateData&&wt();return{c(){r=o("meta"),v=f(),c=o("div"),u=o("div"),k=o("div"),k.innerHTML=ge,Q=f(),y=o("div"),w=o("div"),g=o("h2"),g.textContent=A,ve=f(),I=o("div"),L=o("canvas"),Z=f(),m&&m.c(),xe=f(),N=o("div"),F=o("button"),be=W("📱 分享到社交媒体"),l=f(),t=o("button"),S=W("💾 下载海报"),Ce=f(),p=o("div"),T=o("div"),j=o("h3"),j.textContent=Se,pe=f(),b=o("div"),V=o("div"),H=o("span"),H.textContent=q,M=f(),ee=o("span"),Ee=W(me),je=W(" 秒"),qe=f(),U=o("div"),te=o("span"),te.textContent=nt,Re=f(),le=o("span"),Te=W(_e),Ue=W("/100"),ze=f(),z=o("div"),se=o("span"),se.textContent=rt,Be=f(),oe=o("span"),De=W(ye),Oe=W(" 轮"),Ge=f(),_&&_.c(),Xe=f(),P=o("div"),ae=o("h3"),ae.textContent=it,$e=f(),R=o("textarea"),Ye=f(),B=o("button"),B.textContent=ct,We=f(),O=o("div"),ne=o("h3"),ne.textContent=dt,Je=f(),G=o("div"),X=o("button"),X.textContent=ut,Ke=f(),$=o("button"),$.textContent=ft,Qe=f(),re=o("div"),re.innerHTML=ht,this.h()},l(x){const D=Ft("svelte-x69r32",ot.head);r=a(D,"META",{name:!0,content:!0}),D.forEach(n),v=h(x),c=a(x,"DIV",{class:!0});var we=d(c);u=a(we,"DIV",{class:!0});var ce=d(u);k=a(ce,"DIV",{class:!0,"data-svelte-h":!0}),C(k)!=="svelte-1qqukzg"&&(k.innerHTML=ge),Q=h(ce),y=a(ce,"DIV",{class:!0});var ke=d(y);w=a(ke,"DIV",{class:!0});var de=d(w);g=a(de,"H2",{class:!0,"data-svelte-h":!0}),C(g)!=="svelte-t5htb5"&&(g.textContent=A),ve=h(de),I=a(de,"DIV",{class:!0});var Ie=d(I);L=a(Ie,"CANVAS",{class:!0,style:!0}),d(L).forEach(n),Z=h(Ie),m&&m.l(Ie),Ie.forEach(n),xe=h(de),N=a(de,"DIV",{class:!0});var Fe=d(N);F=a(Fe,"BUTTON",{class:!0});var bt=d(F);be=J(bt,"📱 分享到社交媒体"),bt.forEach(n),l=h(Fe),t=a(Fe,"BUTTON",{class:!0});var pt=d(t);S=J(pt,"💾 下载海报"),pt.forEach(n),Fe.forEach(n),de.forEach(n),Ce=h(ke),p=a(ke,"DIV",{class:!0});var ue=d(p);T=a(ue,"DIV",{class:!0});var Ve=d(T);j=a(Ve,"H3",{class:!0,"data-svelte-h":!0}),C(j)!=="svelte-11a96tr"&&(j.textContent=Se),pe=h(Ve),b=a(Ve,"DIV",{class:!0});var Y=d(b);V=a(Y,"DIV",{class:!0});var Ae=d(V);H=a(Ae,"SPAN",{class:!0,"data-svelte-h":!0}),C(H)!=="svelte-1sq2mom"&&(H.textContent=q),M=h(Ae),ee=a(Ae,"SPAN",{class:!0});var et=d(ee);Ee=J(et,me),je=J(et," 秒"),et.forEach(n),Ae.forEach(n),qe=h(Y),U=a(Y,"DIV",{class:!0});var Ne=d(U);te=a(Ne,"SPAN",{class:!0,"data-svelte-h":!0}),C(te)!=="svelte-1cjb4lt"&&(te.textContent=nt),Re=h(Ne),le=a(Ne,"SPAN",{class:!0});var tt=d(le);Te=J(tt,_e),Ue=J(tt,"/100"),tt.forEach(n),Ne.forEach(n),ze=h(Y),z=a(Y,"DIV",{class:!0});var He=d(z);se=a(He,"SPAN",{class:!0,"data-svelte-h":!0}),C(se)!=="svelte-yoflzt"&&(se.textContent=rt),Be=h(He),oe=a(He,"SPAN",{class:!0});var lt=d(oe);De=J(lt,ye),Oe=J(lt," 轮"),lt.forEach(n),He.forEach(n),Ge=h(Y),_&&_.l(Y),Y.forEach(n),Ve.forEach(n),Xe=h(ue),P=a(ue,"DIV",{class:!0});var fe=d(P);ae=a(fe,"H3",{class:!0,"data-svelte-h":!0}),C(ae)!=="svelte-x6v2s4"&&(ae.textContent=it),$e=h(fe),R=a(fe,"TEXTAREA",{class:!0,placeholder:!0}),d(R).forEach(n),Ye=h(fe),B=a(fe,"BUTTON",{class:!0,"data-svelte-h":!0}),C(B)!=="svelte-1dt3srs"&&(B.textContent=ct),fe.forEach(n),We=h(ue),O=a(ue,"DIV",{class:!0});var Me=d(O);ne=a(Me,"H3",{class:!0,"data-svelte-h":!0}),C(ne)!=="svelte-14944a4"&&(ne.textContent=dt),Je=h(Me),G=a(Me,"DIV",{class:!0});var Pe=d(G);X=a(Pe,"BUTTON",{class:!0,"data-svelte-h":!0}),C(X)!=="svelte-1x4fip0"&&(X.textContent=ut),Ke=h(Pe),$=a(Pe,"BUTTON",{class:!0,"data-svelte-h":!0}),C($)!=="svelte-kdjnux"&&($.textContent=ft),Pe.forEach(n),Me.forEach(n),ue.forEach(n),ke.forEach(n),Qe=h(ce),re=a(ce,"DIV",{class:!0,"data-svelte-h":!0}),C(re)!=="svelte-67fey1"&&(re.innerHTML=ht),ce.forEach(n),we.forEach(n),this.h()},h(){ot.title="分享体验 - 交个神仙朋友",s(r,"name","description"),s(r,"content","分享您的神仙朋友体验，传递内心的平静"),s(k,"class","text-center mb-8"),s(g,"class","text-xl font-semibold text-yellow-100 mb-4"),s(L,"class","max-w-full h-auto rounded-lg shadow-lg border-2 border-yellow-500/30"),Vt(L,"max-height","500px"),s(I,"class","relative inline-block"),F.disabled=ie=i[1]||!i[2],s(F,"class","px-6 py-3 bg-gradient-to-r from-green-600 to-green-500 text-white font-semibold rounded-xl hover:from-green-500 hover:to-green-400 transition-all duration-300 disabled:opacity-50"),t.disabled=E=i[1]||!i[2],s(t,"class","px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white font-semibold rounded-xl hover:from-blue-500 hover:to-blue-400 transition-all duration-300 disabled:opacity-50"),s(N,"class","mt-4 flex flex-col sm:flex-row gap-3 justify-center"),s(w,"class","text-center"),s(j,"class","text-xl font-semibold text-yellow-100 mb-4"),s(H,"class","text-yellow-200"),s(ee,"class","text-yellow-100 font-medium"),s(V,"class","flex justify-between"),s(te,"class","text-yellow-200"),s(le,"class","text-green-400 font-bold"),s(U,"class","flex justify-between"),s(se,"class","text-yellow-200"),s(oe,"class","text-yellow-100 font-medium"),s(z,"class","flex justify-between"),s(b,"class","space-y-4"),s(T,"class","backdrop-blur-subtle rounded-2xl p-6 border border-yellow-500/30 svelte-11i727h"),s(ae,"class","text-xl font-semibold text-yellow-100 mb-4"),s(R,"class","w-full h-24 bg-black/50 border border-yellow-500/50 rounded-xl text-yellow-100 placeholder-yellow-500/50 p-3 resize-none focus:border-yellow-500 focus:outline-none"),s(R,"placeholder","编辑您的分享文案..."),s(B,"class","mt-3 w-full px-4 py-2 bg-yellow-600/20 text-yellow-300 border border-yellow-500/30 rounded-xl hover:bg-yellow-600/30 transition-colors"),s(P,"class","backdrop-blur-subtle rounded-2xl p-6 border border-yellow-500/30 svelte-11i727h"),s(ne,"class","text-xl font-semibold text-yellow-100 mb-4"),s(X,"class","w-full px-6 py-3 bg-gradient-to-r from-yellow-600 to-yellow-500 text-black font-semibold rounded-xl hover:from-yellow-500 hover:to-yellow-400 transition-all duration-300"),s($,"class","w-full px-6 py-3 border-2 border-yellow-500 text-yellow-500 font-semibold rounded-xl hover:bg-yellow-500 hover:text-black transition-all duration-300"),s(G,"class","space-y-3"),s(O,"class","backdrop-blur-subtle rounded-2xl p-6 border border-yellow-500/30 svelte-11i727h"),s(p,"class","space-y-6"),s(y,"class","grid grid-cols-1 lg:grid-cols-2 gap-8"),s(re,"class","mt-12 text-center"),s(u,"class","max-w-4xl mx-auto"),s(c,"class","min-h-screen p-6")},m(x,D){e(ot.head,r),Le(x,v,D),Le(x,c,D),e(c,u),e(u,k),e(u,Q),e(u,y),e(y,w),e(w,g),e(w,ve),e(w,I),e(I,L),i[12](L),e(I,Z),m&&m.m(I,null),e(w,xe),e(w,N),e(N,F),e(F,be),e(N,l),e(N,t),e(t,S),e(y,Ce),e(y,p),e(p,T),e(T,j),e(T,pe),e(T,b),e(b,V),e(V,H),e(V,M),e(V,ee),e(ee,Ee),e(ee,je),e(b,qe),e(b,U),e(U,te),e(U,Re),e(U,le),e(le,Te),e(le,Ue),e(b,ze),e(b,z),e(z,se),e(z,Be),e(z,oe),e(oe,De),e(oe,Oe),e(b,Ge),_&&_.m(b,null),e(p,Xe),e(p,P),e(P,ae),e(P,$e),e(P,R),mt(R,i[3]),e(P,Ye),e(P,B),e(p,We),e(p,O),e(O,ne),e(O,Je),e(O,G),e(G,X),e(G,Ke),e(G,$),e(u,Qe),e(u,re),Ze||(vt=[he(F,"click",i[6]),he(t,"click",i[8]),he(R,"input",i[13]),he(B,"click",i[7]),he(X,"click",i[9]),he($,"click",i[10])],Ze=!0)},p(x,[D]){var we;x[1]?m||(m=yt(),m.c(),m.m(I,null)):m&&(m.d(1),m=null),D&6&&ie!==(ie=x[1]||!x[2])&&(F.disabled=ie),D&6&&E!==(E=x[1]||!x[2])&&(t.disabled=E),D&32&&me!==(me=(x[5].duration||60)+"")&&st(Ee,me),D&32&&_e!==(_e=(x[5].calmScore||75)+"")&&st(Te,_e),D&32&&ye!==(ye=(((we=x[5].chatHistory)==null?void 0:we.length)||0)+"")&&st(De,ye),x[5].certificateData?_||(_=wt(),_.c(),_.m(b,null)):_&&(_.d(1),_=null),D&8&&mt(R,x[3])},i:at,o:at,d(x){x&&(n(v),n(c)),n(r),i[12](null),m&&m.d(),_&&_.d(),Ze=!1,Ct(vt)}}}function Mt(i,r,v){let c,u,k=at,ge=()=>(k(),k=Tt(c,l=>v(5,u=l)),c),Q;St(i,_t,l=>v(11,Q=l)),i.$$.on_destroy.push(()=>k());let y,w=!1,g="",A="";Et(()=>{K("page_view",{page:"share"}),I(),ve()});function ve(){const l=u.calmScore||75,t=u.duration||60,S=[`刚刚体验了${t}秒神仙朋友，平静指数提升到${l}/100！推荐给大家🙏`,`与千年沉香之灵对话，内心获得了前所未有的宁静✨ 平静指数：${l}/100`,`30秒生成AI神仙伴侣，${t}秒情绪急救太治愈了！得分${l}分💫`,"遇见了我的专属神仙朋友，心灵得到了净化和指引🌸 推荐体验！"];v(3,A=S[Math.floor(Math.random()*S.length)])}async function I(){if(y){v(1,w=!0);try{const l=y,t=l.getContext("2d");l.width=540,l.height=960;const S=t.createLinearGradient(0,0,0,l.height);S.addColorStop(0,"#1a1a1a"),S.addColorStop(.5,"#0f0f0f"),S.addColorStop(1,"#1a1a1a"),t.fillStyle=S,t.fillRect(0,0,l.width,l.height),t.strokeStyle="#FFD700",t.lineWidth=4,t.strokeRect(20,20,l.width-40,l.height-40),t.fillStyle="#FFD700",t.font='bold 48px "Noto Serif SC", serif',t.textAlign="center",t.fillText("交个神仙朋友",l.width/2,120),t.fillStyle="#FFF8DC",t.font='24px "Noto Serif SC", serif',t.fillText("千年古寺开光沉香手串",l.width/2,160);const E=200,Ce=(l.width-E)/2,p=220;t.beginPath(),t.arc(l.width/2,p+E/2,E/2,0,2*Math.PI);const T=t.createRadialGradient(l.width/2,p+E/2,0,l.width/2,p+E/2,E/2);T.addColorStop(0,"#FFD700"),T.addColorStop(1,"#DAA520"),t.fillStyle=T,t.fill(),t.fillStyle="#000",t.font='bold 120px "Noto Serif SC", serif',t.fillText("仙",l.width/2,p+E/2+40);const j=u.calmScore||75,Se=u.duration||60;t.fillStyle="#FFF8DC",t.font='28px "Noto Serif SC", serif',t.fillText(`${Se}秒情绪急救`,l.width/2,480),t.fillStyle="#90EE90",t.font='bold 36px "Noto Serif SC", serif',t.fillText(`平静指数 ${j}/100`,l.width/2,530);const pe=["🎯 30秒极速情绪急救","🤖 AI神仙个性化指导","📱 离线可用随时陪伴"];t.fillStyle="#FFF8DC",t.font='20px "Noto Serif SC", serif',pe.forEach((q,M)=>{t.fillText(q,l.width/2,600+M*40)}),t.fillStyle="#FFD700",t.font='18px "Noto Serif SC", serif',t.fillText("扫码体验",l.width/2,800);const b=120,V=(l.width-b)/2,H=820;t.fillStyle="#FFF",t.fillRect(V,H,b,b),t.fillStyle="#000";for(let q=0;q<10;q++)for(let M=0;M<10;M++)(q+M)%2===0&&t.fillRect(V+q*12,H+M*12,12,12);v(2,g=l.toDataURL("image/png",.9))}catch(l){console.error("Poster generation failed:",l)}finally{v(1,w=!1)}}}async function L(){if(g)try{if(navigator.share&&navigator.canShare){const t=await(await fetch(g)).blob(),S=new File([t],"shenxian-poster.png",{type:"image/png"});await navigator.share({title:"交个神仙朋友",text:A,files:[S]}),K("share_success",{method:"web_share_api"})}else Z()}catch(l){console.error("Share failed:",l),K("share_error",{error:l.message}),Z()}}function Z(){const l=`${window.location.origin}/?ref=${Math.random().toString(36).substr(2,9)}`;if(navigator.clipboard)navigator.clipboard.writeText(`${A} ${l}`),alert("分享链接已复制到剪贴板！"),K("share_success",{method:"copy_link"});else{const t=document.createElement("textarea");t.value=`${A} ${l}`,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),alert("分享链接已复制！"),K("share_success",{method:"copy_fallback"})}}function xe(){if(!g)return;const l=document.createElement("a");l.download="神仙朋友分享海报.png",l.href=g,l.click(),K("poster_download")}function N(){_t.set({duration:null,calmScore:null,chatHistory:[],donationAmount:36,breatheStartTime:null,fingerprintHash:null,nfcId:null,certificateData:null}),K("restart_experience"),Nt("/")}function F(){K("explore_more"),alert("更多功能敬请期待！")}function be(l){Dt[l?"unshift":"push"](()=>{y=l,v(0,y)})}function ie(){A=this.value,v(3,A)}return i.$$.update=()=>{i.$$.dirty&2048&&ge(v(4,c=Q))},[y,w,g,A,c,u,L,Z,xe,N,F,Q,be,ie]}class Rt extends kt{constructor(r){super(),It(this,r,Mt,Ht,gt,{})}}export{Rt as component};
